(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforebegin",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.discription=n,this.people=r,this.status=s}}class i{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return t({value:e,required:!0})&&t(s)&&t(i)?[e,n,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"submitHandler",null);class c extends e{get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.discription}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),o.addListener((e=>{e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished)),this.assignedProjects=e,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}}d([n],p.prototype,"dragOverHandler",null),d([n],p.prototype,"dropHandler",null),d([n],p.prototype,"dragLeaveHandler",null),new a,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFDZSxNQUFlQSxFQUs1QixXQUFBQyxDQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBQyxLQUFLQyxnQkFBdUNDLFNBQVNDLGVBQWVQLEdBQ3BFSSxLQUFLSSxZQUFpQkYsU0FBU0MsZUFBZU4sR0FFOUMsTUFBTVEsRUFBZUgsU0FBU0ksV0FDNUJOLEtBQUtDLGdCQUFnQk0sU0FDckIsR0FFRlAsS0FBS1EsUUFBYUgsRUFBYUksa0JBQzVCVixJQUNEQyxLQUFLUSxRQUFRRSxHQUFLWCxHQUdwQkMsS0FBS1csT0FBT2IsRUFDZCxDQUVRLE1BQUFhLENBQU9DLEdBQ2JaLEtBQUtJLFlBQVlTLHNCQUNmRCxFQUFtQixhQUFlLGNBQ2xDWixLQUFLUSxRQUVULEVDckJLLFNBQVNNLEVBQVNDLEdBQ3ZCLElBQUlDLEdBQVUsRUFzQmQsT0FyQklELEVBQWtCRSxXQUNwQkQsRUFBVUEsR0FBZ0UsSUFBckRELEVBQWtCRyxNQUFNQyxXQUFXQyxPQUFPQyxRQUdoQyxNQUEvQk4sRUFBa0JPLFdBQ2lCLGlCQUE1QlAsRUFBa0JHLFFBRXpCRixFQUFVQSxHQUFXRCxFQUFrQkcsTUFBTUcsT0FBU04sRUFBa0JPLFdBR3pDLE1BQS9CUCxFQUFrQlEsV0FDaUIsaUJBQTVCUixFQUFrQkcsUUFFekJGLEVBQVVBLEdBQVdELEVBQWtCRyxNQUFNRyxPQUFTTixFQUFrQlEsV0FFN0MsTUFBekJSLEVBQWtCUyxLQUFrRCxpQkFBNUJULEVBQWtCRyxRQUM1REYsRUFBVUEsR0FBV0QsRUFBa0JHLE1BQVFILEVBQWtCUyxLQUV0QyxNQUF6QlQsRUFBa0JVLEtBQWtELGlCQUE1QlYsRUFBa0JHLFFBQzVERixFQUFVQSxHQUFXRCxFQUFrQkcsTUFBUUgsRUFBa0JVLEtBRTVEVCxDQUNULENDbENPLFNBQVNVLEVBRWRDLEVBQ0FDLEVBQ0FDLEdBRUEsTUFBTUMsRUFBaUJELEVBQVdYLE1BUWxDLE1BUDBDLENBQ3hDYSxjQUFjLEVBQ2QsR0FBQUMsR0FFRSxPQURnQkYsRUFBZUcsS0FBS2pDLEtBRXRDLEVBR0osQ0NmQSxJQUFZa0MsR0FBWixTQUFZQSxHQUNWLHVCQUNBLDBCQUNELENBSEQsQ0FBWUEsSUFBQUEsRUFBYSxLQUtsQixNQUFNQyxFQUNYLFdBQUF4QyxDQUNTZSxFQUNBMEIsRUFDQUMsRUFDQUMsRUFDQUMsR0FKQSxLQUFBN0IsR0FBQUEsRUFDQSxLQUFBMEIsTUFBQUEsRUFDQSxLQUFBQyxZQUFBQSxFQUNBLEtBQUFDLE9BQUFBLEVBQ0EsS0FBQUMsT0FBQUEsQ0FFVCxFQ1RGLE1BQU1DLEVBQU4sY0FFWSxLQUFBQyxVQUEyQixFQUt2QyxDQUhFLFdBQUFDLENBQVlDLEdBQ1YzQyxLQUFLeUMsVUFBVUcsS0FBS0QsRUFDdEIsRUFHSyxNQUFNRSxVQUFxQkwsRUFJaEMsY0FDRU0sUUFKTSxLQUFBQyxTQUFzQixFQUs5QixDQUdBLGtCQUFPQyxHQUNMLE9BQUloRCxLQUFLaUQsV0FHVGpELEtBQUtpRCxTQUFXLElBQUlKLEdBRlg3QyxLQUFLaUQsUUFJaEIsQ0FJQSxVQUFBQyxDQUFXZCxFQUFlZSxFQUFxQkMsR0FDN0MsTUFBTUMsRUFBYSxJQUFJbEIsRUFDckJtQixLQUFLQyxTQUFTcEMsV0FDZGlCLEVBQ0FlLEVBQ0FDLEVBQ0FsQixFQUFjc0IsUUFFaEJ4RCxLQUFLK0MsU0FBU0gsS0FBS1MsR0FDbkJyRCxLQUFLeUQsaUJBQ1AsQ0FFQSxXQUFBQyxDQUFZQyxFQUFtQkMsR0FDN0IsTUFBTUMsRUFBVTdELEtBQUsrQyxTQUFTZSxNQUFLQyxHQUFPQSxFQUFJckQsS0FBT2lELElBQ2pERSxHQUFXQSxFQUFRdEIsU0FBV3FCLElBQ2hDQyxFQUFRdEIsT0FBU3FCLEVBQ2pCNUQsS0FBS3lELGtCQUVULENBRVEsZUFBQUEsR0FDTixJQUFLLE1BQU1PLEtBQWNoRSxLQUFLeUMsVUFDNUJ1QixFQUFXaEUsS0FBSytDLFNBQVNrQixRQUU3QixFQUdLLE1BQU1DLEVBQWVyQixFQUFhRyxjQ3REbEMsTUFBTW1CLFVBQXFCLEVBS2hDLFdBQUF4RSxHQUNFbUQsTUFBTSxnQkFBaUIsT0FBTyxFQUFNLGNBQ3BDOUMsS0FBS29FLGtCQUFzQ3BFLEtBQUtRLFFBQVE2RCxjQUFjLFVBQ3RFckUsS0FBS3NFLHdCQUE0Q3RFLEtBQUtRLFFBQVE2RCxjQUFjLGdCQUM1RXJFLEtBQUt1RSxtQkFBdUN2RSxLQUFLUSxRQUFRNkQsY0FBYyxXQUN2RXJFLEtBQUt3RSxXQUNQLENBRUEsU0FBQUEsR0FDRXhFLEtBQUtRLFFBQVFpRSxpQkFBaUIsU0FBVXpFLEtBQUswRSxjQUMvQyxDQUVBLGFBQUFDLEdBQWlCLENBRVQsZUFBQUMsR0FDTixNQUFNQyxFQUFlN0UsS0FBS29FLGtCQUFrQmxELE1BQ3RDNEQsRUFBcUI5RSxLQUFLc0Usd0JBQXdCcEQsTUFDbEQ2RCxFQUFnQi9FLEtBQUt1RSxtQkFBbUJyRCxNQU14QzhELEVBQWlELENBQ3JEOUQsTUFBTzRELEVBQ1A3RCxVQUFVLEVBQ1ZLLFVBQVcsR0FFUDJELEVBQTRDLENBQ2hEL0QsT0FBUTZELEVBQ1I5RCxVQUFVLEVBQ1ZPLElBQUssRUFDTEMsSUFBSyxHQUdQLE9BQ0csRUFqQjhDLENBQy9DUCxNQUFPMkQsRUFDUDVELFVBQVUsS0FnQlQsRUFBb0IrRCxJQUNwQixFQUFvQkMsR0FLZCxDQUFDSixFQUFjQyxHQUFxQkMsUUFIekNHLE1BQU0sbUNBS1osQ0FFUSxXQUFBQyxHQUNObkYsS0FBS29FLGtCQUFrQmxELE1BQVEsR0FDL0JsQixLQUFLc0Usd0JBQXdCcEQsTUFBUSxHQUNyQ2xCLEtBQUt1RSxtQkFBbUJyRCxNQUFRLEVBQ2xDLENBR1EsYUFBQXdELENBQWNVLEdBRXBCQSxFQUFNQyxpQkFDTixNQUFNQyxFQUFhdEYsS0FBSzRFLGtCQUN4QixHQUFJVyxNQUFNQyxRQUFRRixHQUFhLENBQzdCLE1BQU9sRCxFQUFPcUQsRUFBTW5ELEdBQVVnRCxFQUM5QnBCLEVBQWFoQixXQUFXZCxFQUFPcUQsRUFBTW5ELEdBQ3JDdEMsS0FBS21GLGFBQ1AsQ0FDRixHLDBUQVRRLEVBRFAsRyxrQ0MxREksTUFBTU8sVUFBb0JoRyxFQUcvQixXQUFJaUcsR0FDRixPQUEyQixJQUF4QjNGLEtBQUs2RCxRQUFRdkIsT0FDUCxXQUVBLEdBQUd0QyxLQUFLNkQsUUFBUXZCLGdCQUUzQixDQUVBLFdBQUEzQyxDQUFZaUcsRUFBZ0IvQixHQUMxQmYsTUFBTSxpQkFBa0I4QyxHQUFRLEVBQU8vQixFQUFRbkQsSUFDL0NWLEtBQUs2RCxRQUFVQSxFQUVmN0QsS0FBS3dFLFlBQ0x4RSxLQUFLMkUsZUFDUCxDQUdBLGdCQUFBa0IsQ0FBaUJULEdBQ2ZBLEVBQU1VLGFBQWNDLFFBQVEsYUFBYy9GLEtBQUs2RCxRQUFRbkQsSUFDdkQwRSxFQUFNVSxhQUFjRSxjQUFnQixNQUN0QyxDQUVBLGNBQUFDLENBQWV0RSxHQUNidUUsUUFBUUMsSUFBSSxVQUNkLENBRUEsU0FBQTNCLEdBQ0V4RSxLQUFLUSxRQUFRaUUsaUJBQWlCLFlBQWF6RSxLQUFLNkYsa0JBQ2hEN0YsS0FBS1EsUUFBUWlFLGlCQUFpQixVQUFXekUsS0FBS2lHLGVBQ2hELENBRUEsYUFBQXRCLEdBQ0UzRSxLQUFLUSxRQUFRNkQsY0FBYyxNQUFPK0IsWUFBY3BHLEtBQUs2RCxRQUFRekIsTUFDN0RwQyxLQUFLUSxRQUFRNkQsY0FBYyxNQUFPK0IsWUFBY3BHLEtBQUsyRixRQUFVLFlBQy9EM0YsS0FBS1EsUUFBUTZELGNBQWMsS0FBTStCLFlBQWNwRyxLQUFLNkQsUUFBUXhCLFdBQzlELEcsMFRBbEJBLEVBRENYLEcsK1dDakJJLE1BQU0yRSxVQUFvQjNHLEVBRy9CLFdBQUFDLENBQW9CMkcsR0FDbEJ4RCxNQUFNLGVBQWdCLE9BQU8sRUFBTyxHQUFHd0QsY0FEckIsS0FBQUEsS0FBQUEsRUFFbEJ0RyxLQUFLdUcsaUJBQW1CLEdBRXhCdkcsS0FBS3dFLFlBQ0x4RSxLQUFLMkUsZUFDUCxDQUdBLGVBQUE2QixDQUFnQnBCLEdBQ1ZBLEVBQU1VLGNBQWlELGVBQWhDVixFQUFNVSxhQUFhVyxNQUFNLEtBQ2xEckIsRUFBTUMsaUJBQ1NyRixLQUFLUSxRQUFRNkQsY0FBYyxNQUNuQ3FDLFVBQVVDLElBQUksYUFHekIsQ0FHQSxXQUFBQyxDQUFZeEIsR0FDVixNQUFNeUIsRUFBUXpCLEVBQU1VLGFBQWNnQixRQUFRLGNBQzFDNUMsRUFBYVIsWUFDWG1ELEVBQ2MsV0FBZDdHLEtBQUtzRyxLQUFvQnBFLEVBQWNzQixPQUFTdEIsRUFBYzZFLFNBRWxFLENBR0EsZ0JBQUFDLENBQWlCckYsR0FDQTNCLEtBQUtRLFFBQVE2RCxjQUFjLE1BQ25DcUMsVUFBVU8sT0FBTyxZQUMxQixDQUVBLFNBQUF6QyxHQUNFeEUsS0FBS1EsUUFBUWlFLGlCQUFpQixXQUFZekUsS0FBS3dHLGlCQUMvQ3hHLEtBQUtRLFFBQVFpRSxpQkFBaUIsWUFBYXpFLEtBQUtnSCxrQkFDaERoSCxLQUFLUSxRQUFRaUUsaUJBQWlCLE9BQVF6RSxLQUFLNEcsYUFFM0MxQyxFQUFheEIsYUFBYUssSUFDQ0EsRUFBU21FLFFBQU9uRCxHQUN0QixXQUFkL0QsS0FBS3NHLEtBQ0N2QyxFQUFJeEIsU0FBV0wsRUFBY3NCLE9BRS9CTyxFQUFJeEIsU0FBV0wsRUFBYzZFLFdBRXRDL0csS0FBS3VHLGlCQUFtQnhELEVBQ3hCL0MsS0FBS21ILGdCQUFnQixHQUV6QixDQUVBLGFBQUF4QyxHQUNFLE1BQU15QyxFQUFTLEdBQUdwSCxLQUFLc0csb0JBQ3ZCdEcsS0FBS1EsUUFBUTZELGNBQWMsTUFBTzNELEdBQUswRyxFQUN2Q3BILEtBQUtRLFFBQVE2RCxjQUFjLE1BQU8rQixZQUNoQ3BHLEtBQUtzRyxLQUFLZSxjQUFnQixXQUM5QixDQUVRLGNBQUFGLEdBQ1NqSCxTQUFTQyxlQUFlLEdBQUdILEtBQUtzRyxxQkFDeENnQixVQUFZLEdBQ25CLElBQUssTUFBTUMsS0FBV3ZILEtBQUt1RyxpQkFDekIsSUFBSWIsRUFBWTFGLEtBQUtRLFFBQVE2RCxjQUFjLE1BQU8zRCxHQUFJNkcsRUFFMUQsRUF0REEsR0FEQzdGLEcsb0NBV0QsR0FEQ0EsRyxnQ0FVRCxHQURDQSxHLHFDQ25DSCxJQUFJeUMsRUFDSixJQUFJa0MsRUFBWSxVQUNoQixJQUFJQSxFQUFZLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGVyY2lzZV8wMS8uL3NyYy9jb21wb25lbnQvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vZXhlcmNpc2VfMDEvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL2V4ZXJjaXNlXzAxLy4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vZXhlcmNpc2VfMDEvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vZXhlcmNpc2VfMDEvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly9leGVyY2lzZV8wMS8uL3NyYy9jb21wb25lbnQvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9leGVyY2lzZV8wMS8uL3NyYy9jb21wb25lbnQvcHJvamVjdC1pdGVtLnRzIiwid2VicGFjazovL2V4ZXJjaXNlXzAxLy4vc3JjL2NvbXBvbmVudC9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vZXhlcmNpc2VfMDEvLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvbXBvbmVudCBCYXNlIENsYXNzLCBjYW5gdCBpbnN0YW50aWF0ZVxuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcbiAgaG9zdEVsZW1lbnQ6IFQ7XG4gIGVsZW1lbnQ6IFU7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLCBcbiAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXG4gICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcbiAgICBuZXdFbGVtZW50SWQ/OiBzdHJpbmcsXG4gICkge1xuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gPEhUTUxUZW1wbGF0ZUVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhO1xuICAgIHRoaXMuaG9zdEVsZW1lbnQgPSA8VD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0RWxlbWVudElkKSE7XG5cbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxuICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCwgXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQgPSA8VT5pbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgaWYobmV3RWxlbWVudElkKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XG4gIH1cblxuICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2luaW5nOiBib29sZWFuKSB7XG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXG4gICAgICBpbnNlcnRBdEJlZ2luaW5nID8gJ2FmdGVyYmVnaW4nIDogJ2JlZm9yZWJlZ2luJywgXG4gICAgICB0aGlzLmVsZW1lbnRcbiAgICApO1xuICB9XG5cbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XG5cbiAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOnZvaWQ7XG59IiwiLy8gVmFsaWRhdGlvbiBpbnRlcmZhY2VcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xuICByZXF1aXJlZD86IGJvb2xlYW47XG4gIG1pbkxlbmd0aD86IG51bWJlcjtcbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICBtaW4/OiBudW1iZXI7XG4gIG1heD86IG51bWJlcjtcbn1cblxuLy8gVmFsaWRhdGlvbiBmdW5jdGlvblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKFZhbGlkYXRhYmxlSW5wdXRlOiBWYWxpZGF0YWJsZSkge1xuICBsZXQgaXNWYWxpZCA9IHRydWU7XG4gIGlmIChWYWxpZGF0YWJsZUlucHV0ZS5yZXF1aXJlZCkge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIFZhbGlkYXRhYmxlSW5wdXRlLnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMDtcbiAgfVxuICBpZiAoXG4gICAgVmFsaWRhdGFibGVJbnB1dGUubWluTGVuZ3RoICE9IG51bGwgJiYgXG4gICAgdHlwZW9mIFZhbGlkYXRhYmxlSW5wdXRlLnZhbHVlID09PSAnc3RyaW5nJ1xuICApIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBWYWxpZGF0YWJsZUlucHV0ZS52YWx1ZS5sZW5ndGggPiBWYWxpZGF0YWJsZUlucHV0ZS5taW5MZW5ndGg7XG4gIH1cbiAgaWYgKFxuICAgIFZhbGlkYXRhYmxlSW5wdXRlLm1heExlbmd0aCAhPSBudWxsICYmIFxuICAgIHR5cGVvZiBWYWxpZGF0YWJsZUlucHV0ZS52YWx1ZSA9PT0gJ3N0cmluZydcbiAgKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgVmFsaWRhdGFibGVJbnB1dGUudmFsdWUubGVuZ3RoIDwgVmFsaWRhdGFibGVJbnB1dGUubWF4TGVuZ3RoO1xuICB9XG4gIGlmIChWYWxpZGF0YWJsZUlucHV0ZS5taW4gIT0gbnVsbCAmJiB0eXBlb2YgVmFsaWRhdGFibGVJbnB1dGUudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgVmFsaWRhdGFibGVJbnB1dGUudmFsdWUgPiBWYWxpZGF0YWJsZUlucHV0ZS5taW47XG4gIH1cbiAgaWYgKFZhbGlkYXRhYmxlSW5wdXRlLm1heCAhPSBudWxsICYmIHR5cGVvZiBWYWxpZGF0YWJsZUlucHV0ZS52YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBWYWxpZGF0YWJsZUlucHV0ZS52YWx1ZSA8IFZhbGlkYXRhYmxlSW5wdXRlLm1heDtcbiAgfVxuICByZXR1cm4gaXNWYWxpZDtcbn0iLCIvLyBhdXRvYmluZCBkZWNvcmF0b3JcbmV4cG9ydCBmdW5jdGlvbiBhdXRvYmluZChcbiAgLy9cIl9cIuOBp+Wumue+qeOBleOCjOOBn+OBjOOAgeS9v+OCj+OCjOOBpuOBhOeEoeOBhHBhcmFtZXRlcuOCkuihqOekulxuICBfOiBhbnksIFxuICBfMjogc3RyaW5nLCBcbiAgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yXG4pIHtcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICBjb25zdCBhZGpEZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldCAoKSB7XG4gICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICAgIHJldHVybiBib3VuZEZuO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XG59XG5cblxuIiwiLy8gUHJvamVjdCBUeXBlXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcbiAgQWN0aXZlLFxuICBGaW5pc2hlZFxufVxuXG5leHBvcnQgY2xhc3MgUHJvamVjdCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBpZDpzdHJpbmcsIFxuICAgIHB1YmxpYyB0aXRsZTpzdHJpbmcsIFxuICAgIHB1YmxpYyBkaXNjcmlwdGlvbjpzdHJpbmcsIFxuICAgIHB1YmxpYyBwZW9wbGU6IG51bWJlciwgXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1cykge1xuXG4gIH1cbn1cbiIsImltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcblxuLy9Qcm9qZWN0IFN0YXRlIE1hbmFnZW1lbnRcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcblxuY2xhc3MgU3RhdGU8VD4ge1xuICAvLyBwcm90ZWN0ZWTjga9wcml2YXRl44G744G85ZCM44GY44CB44Gg44GM57aZ5om/Y2xhc3PlhoXjgYvjgonjga7jgqLjgq/jgrvjgrnjgpLoqLHlj69cbiAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xuXG4gIGFkZExpc3RlbmVyKExpc3RlbmVyRm46IExpc3RlbmVyPFQ+KSB7XG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChMaXN0ZW5lckZuKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD4ge1xuICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICAvLyBwcm9qZWN044GuU3RhdGXjgpLlm7rlrprjgZXjgZvjgovjgIFzdGF0aWPjgaflrqPoqIBcbiAgc3RhdGljIGdldEluc3RhbmNlKCkge1xuICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcbiAgICB9XG4gICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKTtcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcbiAgfVxuXG4gIFxuXG4gIGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgbnVtT2ZQZW9wbGU6IG51bWJlcikge1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcbiAgICAgIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSxcbiAgICAgIHRpdGxlLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBudW1PZlBlb3BsZSwgXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxuICAgICk7XG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG4gIH1cblxuICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZChwcmogPT4gcHJqLmlkID09PSBwcm9qZWN0SWQpO1xuICAgIGlmIChwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpIHtcbiAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzO1xuICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpIHtcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcbiAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpOyIsImltcG9ydCBDbXAgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcbmltcG9ydCAqIGFzIFZhbGlkYXRpb24gZnJvbSBcIi4uL3V0aWwvdmFsaWRhdGlvblwiO1xuaW1wb3J0IHsgYXV0b2JpbmQgYXMgQXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcblxuLy8gUHJvamVjdElucHV0IENsYXNzXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ21wPEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gPEhUTUxJbnB1dEVsZW1lbnQ+dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZScpO1xuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJyk7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpOyAgXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgfVxuICBcbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIpO1xuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHt9XG5cbiAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XG4gICAgY29uc3QgZW50ZXJlZFRpdGxlID0gdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZTtcbiAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcblxuICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogZW50ZXJlZFRpdGxlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfTtcbiAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiA1XG4gICAgfTtcbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcbiAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluOiAxLFxuICAgICAgbWF4OiA1XG4gICAgfTtcblxuICAgIGlmIChcbiAgICAgICFWYWxpZGF0aW9uLnZhbGlkYXRlKHRpdGxlVmFsaWRhdGFibGUpIHx8XG4gICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRhYmxlKSB8fFxuICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUocGVvcGxlVmFsaWRhdGFibGUpXG4gICAgKSB7XG4gICAgICAgIGFsZXJ0KCdJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNsZWFySW5wdXRzKCkge1xuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcbiAgfVxuXG4gIEBBdXRvYmluZFxuICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XG4gICAgLy8g44OH44OV44Kp44Or44OI44GuSFRNTCByZXF1ZXN044KS6YG/44GR44KLXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySW5wdXRlID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXRlKSkge1xuICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0ZTtcbiAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xuICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xuICAgIH0gICAgXG4gIH1cbn0iLCJpbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcblxuLy8gUHJvamVjdEl0ZW0gY2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdnYWJsZSB7XG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcbiAgXG4gIGdldCBwZXJzb25zKCkge1xuICAgIGlmKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcbiAgICAgIHJldHVybiBcIjEgcGVyc29uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihob3N0SUQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xuICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJRCwgZmFsc2UsIHByb2plY3QuaWQpO1xuICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xuICB9XG5cbiAgZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XG4gICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgXCIgYXNzaWduZWRcIjsgLy90aGlzLnBlcnNvbnPjga/nm7TmjqVnZXR0ZXLjgpLkvb/nlKjjgIHvvIjvvInjgpLjgaTjgZHjgovjga7jga/kuI3opoFcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kaXNjcmlwdGlvbjtcbiAgfVxufSIsImltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcbmltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tICcuL3Byb2plY3QtaXRlbSc7XG5cbi8vIFByb2plY3RMaXN0IENsYXNzXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xuICBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcbiAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xuICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdO1xuICAgIFxuICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykgeyAgLy9kcmFn44GV44KM44GfZGF0YeOBrmZvcm1hdOOCkueiuuWumu+8mid0ZXh0L3BsYWluJ1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKTtcbiAgICB9XG4gICAgXG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG4gICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KFxuICAgICAgcHJqSWQsIFxuICAgICAgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxuICAgICk7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcbiAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xuXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XG4gICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKHByaiA9PiB7XG4gICAgICAgIGlmKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHByb2plY3RzO1xuICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHtcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3QtbGlzdGA7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IFxuICAgICAgdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyAnIFBST0pFQ1RTJztcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyUHJvamVjdHMoKSB7XG4gICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlfS1wcm9qZWN0LWxpc3RgKSBhcyBIVE1MVUxpc3RFbGVtZW50O1xuICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJztcbiAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XG4gICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKVxuICAgIH1cbiAgfVxufVxuXG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnQvcHJvamVjdC1pbnB1dFwiO1xuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnQvcHJvamVjdC1saXN0XCI7XG5cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJyk7XG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7Il0sIm5hbWVzIjpbIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2luaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwidmFsaWRhdGUiLCJWYWxpZGF0YWJsZUlucHV0ZSIsImlzVmFsaWQiLCJyZXF1aXJlZCIsInZhbHVlIiwidG9TdHJpbmciLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiYXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRpc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiU3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsIkxpc3RlbmVyRm4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwic3VwZXIiLCJwcm9qZWN0cyIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwiZGVzY3JpcHRpb24iLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsImxpc3RlbmVyRm4iLCJzbGljZSIsInByb2plY3RTdGF0ZSIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwiY29uZmlndXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJyZW5kZXJDb250ZW50IiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiY2xlYXJJbnB1dHMiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0ZSIsIkFycmF5IiwiaXNBcnJheSIsImRlc2MiLCJQcm9qZWN0SXRlbSIsInBlcnNvbnMiLCJob3N0SUQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsImNvbnNvbGUiLCJsb2ciLCJ0ZXh0Q29udGVudCIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwicHJqSWQiLCJnZXREYXRhIiwiRmluaXNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iXSwic291cmNlUm9vdCI6IiJ9